1. CSV file with "," delimiter and the Masterliste Excel File are taken as an input in the GUI window.
2. The data in the Masterliste Excel File has to be in the first worksheet to the left.
3. Mandatory columns are "STRAßE", "HAUSNUMMER", "HAUSNUMMERNZUSATZ", "POP_CLUSTER", "GF-AP-ID", "Home-ID GF-AP"for the Masterliste file and "Directory path", "GF-AP-ID", "Home-ID GF-AP" for the CSV file. The tool is iterating over each row in CSV & Masterliste files and proceeding if both have the same PoP number or when they do not have it specified. The number is derived from the "POP_CLUSTER" column in the Masterliste and from the directory path in the CSV file. It is taking the first number after "POP", with an optional whitespace between them.
4. The join function is further proceeding when either "GF-AP-ID" or "Home-ID GF-AP" column exists and has a match in both files. Formulas are not allowed.
5. When both columns mentioned above fail to match, there is an addresses comparison. For the Masterliste it is combining "STRAßE" + "HAUSNUMMER" + "HAUSNUMMERNZUSATZ" columns, and for the CSV - it is taking the last folder in the Directory path.
6. There is a column "Match with GF-AP-ID or Home-ID GF-AP or Address" created in both CSV and Masterliste files which contains a value indicating whether a match occured. For "TRUE" outcome - it is also specified by which column a given row was matched. In the CSV File there is no FALSE result to make it possible to run the tool multiple times, since there can be Masterliste for each POP but CSV file is always one.
7. All the columns from the CSV file are appended to the Masterliste file. If a column name already exists, there is "_csv" added to the column name.
8. In the newly joined columns, empty cells are filled in red.
9. After selecting the file paths and clicking "Run", the scipt is launched and when it concludes, a pop-up window is shown with its result message.
10. Outputs are saved in the same directory as inputs, with their existing names and "updated_{current_date}" appended.
11. If the Masterliste file of that name already exists, it adds "_(1)" to the name, then "_(2)", "_(3)" and so on.
12. The updated CSV File is first created with "_updated" added to the name and then overwritten if run again to allow collecting data from many Masterliste files.